<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh_Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<script data-ad-client="ca-pub-7298119761242775" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="note,hive,">








  <link rel="shortcut icon" type="image/x-icon" href="/images/avatar.jpg?v=5.1.2">






<meta name="description" content="Introduction to HiveDifference between SQL and NoSQL  SQLRelational, Analytical(OLAP) NoSQLDocument, Key-Value, Column-Family, Graph  What is Hive It is an open-source data warehouse system for queryi">
<meta name="keywords" content="note,hive">
<meta property="og:type" content="article">
<meta property="og:title" content="Hive笔记">
<meta property="og:url" content="beiyuouo.github.io/blog/note-hive/index.html">
<meta property="og:site_name" content="北屿">
<meta property="og:description" content="Introduction to HiveDifference between SQL and NoSQL  SQLRelational, Analytical(OLAP) NoSQLDocument, Key-Value, Column-Family, Graph  What is Hive It is an open-source data warehouse system for queryi">
<meta property="og:locale" content="zh_Hans">
<meta property="og:image" content="/img/note-hive/20200311100017.png">
<meta property="og:image" content="/img/note-hive/20200311102124.png">
<meta property="og:image" content="/img/note-hive/202003121535.png">
<meta property="og:updated_time" content="2020-03-26T12:27:13.487Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hive笔记">
<meta name="twitter:description" content="Introduction to HiveDifference between SQL and NoSQL  SQLRelational, Analytical(OLAP) NoSQLDocument, Key-Value, Column-Family, Graph  What is Hive It is an open-source data warehouse system for queryi">
<meta name="twitter:image" content="/img/note-hive/20200311100017.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="beiyuouo.github.io/blog/note-hive/">







  <title>Hive笔记 | 北屿</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-145083103-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d396c00ca4fe6547a19249d34cb91254";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh_Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">北屿</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">北屿小智障</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-game">
          <a href="/game/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-gamepad"></i> <br>
            
            Game
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            Sitemap
          </a>
        </li>
      
        
        <li class="menu-item menu-item-cv">
          <a href="/cv/cv.pdf" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-file-pdf-o"></i> <br>
            
            CV
          </a>
        </li>
      
        
        <li class="menu-item menu-item-paper-note">
          <a href="/paper-note/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-file-text"></i> <br>
            
            Paper-note
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="beiyuouo.github.io/blog/note-hive/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="北屿">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北屿">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Hive笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-11T09:58:40+08:00">
                2020-03-11
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-03-26T20:27:13+08:00">
                2020-03-26
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  6.6k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  34
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Introduction-to-Hive"><a href="#Introduction-to-Hive" class="headerlink" title="Introduction to Hive"></a>Introduction to Hive</h2><h3 id="Difference-between-SQL-and-NoSQL"><a href="#Difference-between-SQL-and-NoSQL" class="headerlink" title="Difference between SQL and NoSQL"></a>Difference between SQL and NoSQL</h3><p><img src="/img/note-hive/20200311100017.png" alt></p>
<ul>
<li>SQL<br>Relational, Analytical(OLAP)</li>
<li>NoSQL<br>Document, Key-Value, Column-Family, Graph</li>
</ul>
<h3 id="What-is-Hive"><a href="#What-is-Hive" class="headerlink" title="What is Hive"></a>What is Hive</h3><ul>
<li><p>It is an open-source data warehouse system for querying and analyzing large data set stored in HDFS.<br>它是一个开源数据仓库系统，用于查询和分析存储在HDFS中的大数据集。</p>
</li>
<li><p>Its highly scalable.<br>其高度可扩展性。</p>
</li>
<li><p>Hive uses HQL(Hive + SQL) for data summarization, querying and analysis.<br>Hive使用HQL（Hive + SQL）进行数据汇总，查询和分析。</p>
</li>
<li><p>HQL will be converted into map reduce jobs by the Hive component.<br>Hive组件将把HQL转换为map reduce作业</p>
</li>
</ul>
<h3 id="Who-developed-Hive"><a href="#Who-developed-Hive" class="headerlink" title="Who developed Hive"></a>Who developed Hive</h3><ul>
<li><p>Hive was originally developed by Facebook and is now maintained as Apache hive by Apache software foundation.<br>Hive最初由Facebook开发，现在由Apache软件基金会维护为Apache hive。</p>
</li>
<li><p>It is used and developed by biggies such as Netflix and Amazon as well.<br>它也由Netflix和Amazon等大型公司使用和开发</p>
</li>
</ul>
<h3 id="Why-Hive-was-developed"><a href="#Why-Hive-was-developed" class="headerlink" title="Why Hive was developed?"></a>Why Hive was developed?</h3><ul>
<li><p>Traditional organization uses data warehouses that are based on SQL, with users and developers that rely on SQL queries for extracting data.<br>传统组织使用基于SQL的数据仓库，而用户和开发人员则依赖SQL查询来提取数据。</p>
</li>
<li><p>The Hadoop ecosystem is not just scalable but also cost effective when it comes to processing large volumes of data.<br>Hadoop生态系统不仅具有可扩展性，而且在处理大量数据时也具有成本效益。</p>
</li>
<li><p>It makes getting used to the Hadoop ecosystem an uphill task. And that is exactly why hive was developed.<br>这使习惯Hadoop生态系统成为一项艰巨的任务。这就是开发Hive的原因。</p>
</li>
<li><p>Hive provides SQL intellect, so that users can write SQL like queries called HQL or hive query language to extract the data from Hadoop.<br>Hive提供了SQL知识，因此用户可以编写类似HQL的查询之类的SQL或Hive查询语言来从Hadoop提取数据。</p>
</li>
</ul>
<h3 id="How-and-when-it-can-be-used"><a href="#How-and-when-it-can-be-used" class="headerlink" title="How and when it can be used?"></a>How and when it can be used?</h3><ul>
<li><p>Hive can be used for OLAP (online analytic) processing.<br>Hive可用于OLAP（在线分析）处理。</p>
</li>
<li><p>It is scalable, fast and flexible.<br>它具有可扩展性，快速性和灵活性。</p>
</li>
<li><p>It is a great platform for the SQL users to write SQL like queries to interact with the large datasets that reside on HDFS filesystem.<br>对于SQL用户而言，这是一个很棒的平台，可以编写类似于查    询的SQL来与驻留在HDFS文件系统上的大型数据集进行交互</p>
</li>
</ul>
<h3 id="When-Hive-cannot-be-used"><a href="#When-Hive-cannot-be-used" class="headerlink" title="When Hive cannot be used?"></a>When Hive cannot be used?</h3><ul>
<li>It is not a relational database.</li>
<li>It cannot be used fir OLTP(online transaction) processing.</li>
<li>It cannote be used for real time updates or queries.</li>
<li>It cannot be used for scenarios where low latency data retrieval is expected, because there is sa latency in converting the HIVE scripts into MAP REDUCE scripts by Hive.</li>
</ul>
<h3 id="Features-of-Hive"><a href="#Features-of-Hive" class="headerlink" title="Features of Hive"></a>Features of Hive</h3><ul>
<li><p>It supports different file formats like sequence file, text file, avro file format, ORC file, RC file.<br>它支持不同的文件格式，例如序列文件，文本文件，avro文件格式，    ORC文件，RC文件。</p>
</li>
<li><p>Metadata gets stored in RDBMS like derby database.<br>元数据像derby数据库一样存储在RDBMS中。</p>
</li>
<li><p>Hive provides lot of compression techniques, queries on the compressed data such as SNAPPY compression, gzip compression.<br>Hive提供了许多压缩技术，可以对压缩数据进行查询，例如SNAPPY    压缩，gzip压缩。</p>
</li>
<li><p>Users can write SQL like queries that hive converts into mapreduce or tez or spark jobs to query against hadoop datasets.<br>用户可以编写类似查询的SQL，将配置单元转换为mapreduce或tez或    spark作业，以针对hadoop数据集进行查询。</p>
</li>
<li><p>Users can plugin mapreduce scripts into the hive queries using UDF user defined functions.<br>用户可以使用UDF用户定义的函数将mapreduce脚本插入到配置单元    查询中。</p>
</li>
<li><p>Specialized joins are available that help to improve the query performance.<br>可以使用专用联接来帮助提高查询性能</p>
</li>
</ul>
<h3 id="Difference-between-Hive-amp-RDBMS"><a href="#Difference-between-Hive-amp-RDBMS" class="headerlink" title="Difference between Hive &amp; RDBMS"></a>Difference between Hive &amp; RDBMS</h3><p><img src="/img/note-hive/20200311102124.png" alt></p>
<h2 id="Hive-Chapter-1"><a href="#Hive-Chapter-1" class="headerlink" title="Hive Chapter 1"></a>Hive Chapter 1</h2><h3 id="What-is-Hive-1"><a href="#What-is-Hive-1" class="headerlink" title="What is Hive?"></a>What is Hive?</h3><ul>
<li>HIVE is a data warehouse architecture built on the Hadoop file system.<br>HIVE是一个建立在Hadoop文件系统上的数据仓库架构。</li>
<li>HIVE analyzes and manages the data stored in HDFS.<br>HIVE分析和管理存储在HDFS中的数据。                </li>
<li>It mainly provides the following functions:主要提供以下功能:<br>Provides a series of tools for extracting / transforming / loading data (ETL)<br>提供了一系列用于提取/转换/加载数据(ETL)的工具</li>
<li>Is a mechanism that can store, query, and analyze large-scale data stored in HDFS (or HBase)<br>是一种可以存储、查询和分析储存于HDFS(或HBase)中的大规模数据的机制</li>
<li>The query is done through MapReduce (not all queries require MapReduce to complete, such as <code>select * from XXX</code> is not required;<br>查询是通过MapReduce完成的(并不是所有的查询都需要MapReduce来完成，例如从XXX中选择<code>select *</code>是不需要的);</li>
<li>In Hive, queries like <code>select a, b from XXX</code> can be configured without MapReduce through configuration.<br>在Hive中，像从XXX中选择<code>a, b</code>这样的查询可以在没有MapReduce的情况下通过配置进行配置。</li>
</ul>
<h3 id="How-to-analyze-and-manage-data-如何分析和管理数据"><a href="#How-to-analyze-and-manage-data-如何分析和管理数据" class="headerlink" title="How to analyze and manage data? 如何分析和管理数据?"></a>How to analyze and manage data? 如何分析和管理数据?</h3><ul>
<li>Hive defines a SQL-like query language called HQL.<br>Hive定义了一种类似SQL的查询语言，称为HQL。</li>
<li>Hive can be used to query data directly.<br>Hive可以用于直接查询数据。</li>
<li>At the same time, the language also allows developers to develop custom mappers and reducers to handle complex analysis tasks that the built-in mappers and reducers cannot complete.<br>与此同时，该语言还允许开发人员开发定制的Mappers和Reducers来处理内置的Mappers和Reducers无法完成的复杂分析任务。</li>
<li>Hive allows users to write their own function UDFs.<br>Hive允许用户编写自己的函数UDFs。</li>
<li>There are three types of UDFs in Hive: 在Hive中有三种类型的UDFs:<ul>
<li>User Defined Functions (UDF) 用户定义函数(UDF)</li>
<li>User Defined Aggregation Functions (UDAF) 用户定义聚合函数(UDAF)</li>
<li>User Defined Table Generating Functions (UDTF). 用户定义的表生成函数(UDTF)</li>
</ul>
</li>
<li>Hive parses external tasks into a MapReduce executable plan. MapReduce is a high-latency event.<br>Hive将外部任务解析为MapReduce可执行计划。MapReduce是一个高延迟的事件。</li>
<li>Each submission and execution of a task takes a lot of time, which determines that Hive can only handle some high-latency application.<br>任务的每次提交和执行都需要大量的时间，这决定了Hive只能处理一些高延迟的应用程序</li>
<li>Hive currently has the following disadvantages： 目前Hive有以下缺点:<ul>
<li>Hive does not  support transactions; Hive不支持交易;</li>
<li>Table data cannot be modified 无法修改表数据</li>
<li>Columns cannot be indexed 列不能被索引</li>
</ul>
</li>
</ul>
<h3 id="HIVE-Data-Storage-Model-HIVE数据存储模型"><a href="#HIVE-Data-Storage-Model-HIVE数据存储模型" class="headerlink" title="HIVE Data Storage Model.  HIVE数据存储模型"></a>HIVE Data Storage Model.  HIVE数据存储模型</h3><p>HIVE data is divided into :   Hive数据分为：</p>
<ul>
<li>Table data : Table data is the data that tables in Hive have<br>表数据: 表数据是Hive中的表所拥有的数据</li>
<li>Metadata : Metadata is used to store the data about the table.<br>元数据: 元数据用于存储关于表的数据。</li>
</ul>
<h3 id="HIVE-Data-Storage-Hive数据存储"><a href="#HIVE-Data-Storage-Hive数据存储" class="headerlink" title="HIVE Data Storage. Hive数据存储"></a>HIVE Data Storage. Hive数据存储</h3><ul>
<li>Hive is based on the Hadoop distributed file system.<br>Hive是基于Hadoop分布式的文件系统</li>
<li>HIVE data is stored in the Hadoop distributed file system.<br>Hive数据存储在Hadoop分布式文件系统中</li>
<li>We  only need to specify  the column and row separators in the data when we  create the table.<br>我们只需要在创建表时指定数据中的列和行分隔符。</li>
<li>Hive can parse the data.<br>Hive可以解析数据。</li>
<li>Importing  HDFS data into a Hive table is simply moving the data to the directory where the table is located.<br>将HDFS数据导入到Hive表中只是将数据移动到表所在的目录中。</li>
<li>The data in the local file system, need to copy in the same directory of the table.<br>数据在本地文件系统中，需要复制在相同目录下的表。</li>
</ul>
<h3 id="Hive-Data-Models-Table-Hive-数据模型-Table"><a href="#Hive-Data-Models-Table-Hive-数据模型-Table" class="headerlink" title="Hive Data Models-Table. Hive 数据模型-Table"></a>Hive Data Models-Table. Hive 数据模型-Table</h3><ul>
<li>Tables in Hive are similar in concept to tables in relational databases.<br>Hive中的表在概念上与关系数据库中的表相似。</li>
<li>Each table has a corresponding directory in HDFS to store the table’s data.<br>每个表在HDFS中都有一个对应的目录来存储表的数据。</li>
<li>This directory can be accessed through <code>$ {HIVE_HOME} / conf / hive-site</code>.<br>可以通过<code>$ {HIVE_HOME} / conf / hive-site</code> 访问这个目录。</li>
<li>The <code>hive.metastore.warehouse.dir</code> property in the xml configuration file is used to configure.<br><code>hive.metastore.warehouse.dir</code> 属性在xml配置文件中进行配置。</li>
<li>The default value of this property is <code>/ user / hive / warehouse</code> (this directory is on HDFS).         此属性的默认值是<code>/ user / hive / warehouse</code>(此目录位于HDFS上)。</li>
<li>We can modify this configuration according to requirement.<br>我们可以根据需要修改这个配置。</li>
</ul>
<h3 id="Hive-Data-Models-External-Table-Hive-数据模型"><a href="#Hive-Data-Models-External-Table-Hive-数据模型" class="headerlink" title="Hive Data Models-External Table. Hive 数据模型"></a>Hive Data Models-External Table. Hive 数据模型</h3><ul>
<li>The external table in HIVE is very similar to the table, but its data is not stored in the directory to which the table belongs but stored elsewhere.<br>HIVE中的external table(外部表)与该表非常相似，但是它的数据不是存储在该表所属的目录中，而是存储在其他地方。</li>
<li>If we delete the data of external table, the data pointed to by the external table is not  deleted, it deletes the metadata corresponding to the external table<br>如果我们删除了外部表的数据，external table(外部表)指向的数据并没有被删除，它删除了与external table(外部表)对应的元数据</li>
<li>If we want to delete the table, all the data corresponding to the table including the metadata will be deleted.<br>如果要删除该表，则删除该表所对应的所有数据，包括元数据。</li>
</ul>
<h3 id="Hive-Data-Models-Partition-Hive-数据模型-Partition"><a href="#Hive-Data-Models-Partition-Hive-数据模型-Partition" class="headerlink" title="Hive Data Models-Partition. Hive 数据模型-Partition"></a>Hive Data Models-Partition. Hive 数据模型-Partition</h3><ul>
<li>In Hive, each partition of the table corresponds to the respective  directory under the table, and the data of all partitions is stored in the corresponding directory.<br>在Hive中，表的每个分区对应于表下的各个目录，所有partitions(分区)的数据都    存储在相应的目录中。</li>
</ul>
<h3 id="Hive-Data-Models-Bucket-Hive-数据模型-Bucket"><a href="#Hive-Data-Models-Bucket-Hive-数据模型-Bucket" class="headerlink" title="Hive Data Models-Bucket. Hive 数据模型-Bucket"></a>Hive Data Models-Bucket. Hive 数据模型-Bucket</h3><ul>
<li>Calculate the hash of the specified column and slice the data according to the hash value.<br>指定列计算 hash，并根据 hash 值切分数据。</li>
<li>The purpose is to parallelize each bucket corresponding to a file<br>其目的是将每个Bucket(桶)对应于一个文件并行化</li>
</ul>
<h3 id="Hive-MetaData"><a href="#Hive-MetaData" class="headerlink" title="Hive MetaData"></a>Hive MetaData</h3><ul>
<li>The metadata in Hive includes the name of the table, the columns and partitions of the table and their attributes<br>Hive中的元数据包括表的名称、列和表的partitions(分区)以及它们的属性</li>
<li>HIVE metadata needs to be constantly updated and modified.<br>HIVE元数据需要不断更新和修改。</li>
<li>Files in the HDFS system are available for read operation more and does not support frequent  modification, hence we  cannot store Hive’s metadata in HDFS.<br>HDFS系统中的文件可用于更多的读取操作，不支持频繁的修改，因此我们不能将Hive的元数据存储在HDFS中。</li>
<li>Currently Hive stores metadata in databases, such as Mysql and Derby.<br>目前Hive将元数据存储在数据库中，如MySQL和Derby。</li>
</ul>
<h3 id="Hive-Storage-model"><a href="#Hive-Storage-model" class="headerlink" title="Hive Storage model"></a>Hive Storage model</h3><p><img src="/img/note-hive/202003121535.png" alt></p>
<h3 id="Database-Model"><a href="#Database-Model" class="headerlink" title="Database Model"></a>Database Model</h3><p>The ACID acronym stands for:</p>
<ul>
<li>Atomic<br>All operations in a transaction succeed or every operation is rolled back.</li>
<li>Consistent<br>On the completion of a transaction, the database is structurally sound.</li>
<li>Isolated<br>Transactions do not contend with one another. Contentious access to data is moderated by the database so that transactions appear to run sequentially.</li>
<li>Durable<br>The results of applying a transaction are permanent, even in the presence of failures.</li>
</ul>
<p>ACID properties mean that once a transaction is complete, its data is consistent (tech lingo: write consistency) and stable on disk, which may involve multiple distinct memory locations.</p>
<p>Write consistency is a wonderful thing for application developers, but it also requires sophisticated locking which is typically a heavyweight pattern for most use cases.<br>When it comes to NoSQL technologies, most graph databases(including Neo4j) use an ACID consistency model to ensure data is safe and consistently stored.</p>
<p>Here’s how the BASE acronym breaks down:</p>
<ul>
<li>Basic Availability<br>The database appears to work most of the time.</li>
<li>Soft-state<br>Stores don’t have to be write-consistent, nor do different replicas have to be mutually consistent all the time.</li>
<li>Eventual consistency</li>
</ul>
<p>Stores exhibit consistency at some later point (e.g., lazily at read time).<br>BASE properties are much looser than ACID guarantees, but there isn’t a direct one-for-one mapping between the two consistency models (a point that probably can’t be overstated).</p>
<p>A BASE data store values availability (since that’s important for scale), but it doesn’t offer guaranteed consistency of replicated data at write time. Overall, the BASE consistency model provides a less strict assurance than ACID: data will be consistent in the future, either at read time (e.g., Riak) or it will always be consistent, but only for certain processed past snapshots (e.g., Datomic).</p>
<p>The BASE consistency model is primarily used by aggregate stores, including column family, key-value and document stores.</p>
<h3 id="Hive-Installation"><a href="#Hive-Installation" class="headerlink" title="Hive Installation"></a>Hive Installation</h3><h4 id="基于Derby"><a href="#基于Derby" class="headerlink" title="基于Derby"></a>基于Derby</h4><ol>
<li>下载<br><a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-1.2.2/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-1.2.2/</a></li>
<li>将文件传到Linux <code>/home/hadoop/Download</code></li>
<li>解压<br>到<code>~/Download</code>目录下找到文件，<code>tar -zvxf apache-hive-1.2.2-bin.tar.gz -C ~/app/</code></li>
<li><code>vi ~/.bash_profile</code>在最后添加两行<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HIVE_HOME=/home/hadoop/app/apache-hive-1.2.2-bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>最后<code>source ~/.bash_profile</code></p>
<ol>
<li>输入<code>hive --version</code>查看是否安装成功</li>
<li><p>开启hadoop <code>start-all.sh</code><br>运行下面的</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir -p /user/hive/warehouse</span><br><span class="line">hdfs dfs -mkdir  /user/hive/tmp</span><br><span class="line">hdfs dfs -mkdir  /user/hive/<span class="built_in">log</span></span><br><span class="line">hdfs dfs -chmod g+w /user/hive/warehouse</span><br><span class="line">hdfs dfs -chmod g+w /user/hive/tmp</span><br><span class="line">hdfs dfs -chmod g+w /user/hive/<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>然后去<code>/home/hadoop/app/apache-hive-1.2.2-bin/conf</code>copy一下模板修改<code>hive-site.xml</code>和<code>hive-env.sh</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp hive-env.sh.template hive-env.sh</span><br><span class="line">cp hive-default.xml.template hive-default.xml</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在<code>hive-env.sh</code>中添加<code>vi hive-env.sh</code><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HADOOP_HOME=/home/hadoop/app/hadoop-2.7.3</span><br><span class="line"><span class="built_in">export</span> HIVE_CONF_DIR=/home/hadoop/app/apache-hive-1.2.2-bin/conf</span><br><span class="line"><span class="built_in">export</span> HIVE_AUX_JARS_PATH=/home/hadoop/app/apache-hive-1.2.2-bin/lib</span><br></pre></td></tr></table></figure></p>
<p>新建<code>hive-site.xml</code>添加<code>vi hive-site.xml</code><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.exec.scratdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.querylog.location<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/log<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:derby:;databaseName=/home/hadoop/app/apache-hive-1.2.2-bin/metastore_db;create=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.derby.jdbc.EmbeddedDriver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.PersistenceManagerFactoryClass<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.datanucleus.api.jdo.JDOPersistenceManagerFactory<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>system:java.io.tmpdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>初始化数据库<br><code>schematool -initSchema -dbType derby</code></p>
</li>
<li><p>加权限</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chgrp -R hadoop /user/hive/</span><br><span class="line">sudo chown -R hadoop /user/hive/</span><br></pre></td></tr></table></figure>
</li>
<li><p>开启hive <code>hive</code></p>
</li>
</ol>
<h4 id="基于Mysql"><a href="#基于Mysql" class="headerlink" title="基于Mysql"></a>基于Mysql</h4><ol>
<li><p>jar包<br>mpsql - JDBC <a href="https://dev.mysql.com/downloads/connector/j/" target="_blank" rel="noopener">https://dev.mysql.com/downloads/connector/j/</a><br>这个jar包放在<code>${HIVE_HOME}/lib</code>中，</p>
</li>
<li><p><code>hive-site.xml</code>配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://192.168.0.104:3306/hive?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 这里填自己的地址，URL里添加创建数据库好像我的不行 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span> <span class="comment">&lt;!-- 用户名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hive<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span> <span class="comment">&lt;!-- 密码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hive1234<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>system:java.io.tmpdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.exec.scratdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.querylog.location<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/log<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>mysql添加用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> hive;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">'hive'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'hive1234'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'hive'</span>@<span class="string">'%'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化数据库<br><code>schematool -initSchema -dbType mysql</code></p>
</li>
<li><p>启动hive <code>hive</code></p>
</li>
</ol>
<h3 id="CLI-Options"><a href="#CLI-Options" class="headerlink" title="CLI Options"></a>CLI Options</h3><p>The Hive command line interface (CLI) is used to interact with Hive. Users can use CLI commands to create, manage, and query tables.<br>Hive命令行接口(CLI)用于与Hive交互。用户可以使用CLI命令来创建、管理和查询表。<br>You can view the related instructions of Hive through the help command of Hive.<br>你可以通过Hive的help命令查看Hive的相关指令。 <code>hive --help --service cli</code></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Usage</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>-d,--define &lt;key=value&gt;</code></td>
<td style="text-align:center">Variable subsitution to apply to hive commands. e.g. <code>hive -d A=B</code></td>
</tr>
<tr>
<td style="text-align:center"><code>--database &lt;databasename&gt;</code></td>
<td style="text-align:center">Specify the database to use</td>
</tr>
<tr>
<td style="text-align:center"><code>-e &lt;quoted-query-string&gt;</code></td>
<td style="text-align:center">SQL from command line</td>
</tr>
<tr>
<td style="text-align:center"><code>-f &lt;filename&gt;</code></td>
<td style="text-align:center">SQL from file</td>
</tr>
<tr>
<td style="text-align:center"><code>-H, --help</code></td>
<td style="text-align:center">Print help information</td>
</tr>
<tr>
<td style="text-align:center"><code>--hiveconf &lt;property=value&gt;</code></td>
<td style="text-align:center">Use value for give property</td>
</tr>
<tr>
<td style="text-align:center"><code>--hivevar &lt;key=value&gt;</code></td>
<td style="text-align:center">Varibale subsitution to apply to hive commands.</td>
</tr>
<tr>
<td style="text-align:center"><code>-i &lt;filename&gt;</code></td>
<td style="text-align:center">Initialization SQL file</td>
</tr>
<tr>
<td style="text-align:center"><code>-S, --silent</code></td>
<td style="text-align:center">Silent mode in interactive shell</td>
</tr>
<tr>
<td style="text-align:center"><code>-v,--verbose</code></td>
<td style="text-align:center">Verbose mode (echo executed SQL to the console)</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Variable-setting"><a href="#Variable-setting" class="headerlink" title="Variable setting"></a>Variable setting</h3><p>Hive variables are preceded by a namespace, including 4 hiveconf, system, env, and hivevar.<br>Hive变量前有一个名称空间，包括这4个:  hiveconf、system、env和hivevar。</p>
<ul>
<li>hiveconf: refers to the value of configuration variables under hive-site.xml.<br>hiveconf: 指的是hive-site.xml下的配置变量的值。</li>
<li>system: is a system variable, including the running environment of the JVM.<br>system: 是一个系统变量，包括JVM的运行环境。</li>
<li>env: refers to environment variables, including variable information in the Shell environment, such as HADOOP_HOME.<br>env: 指的是环境变量，包括Shell环境中的变量信息，如HADOOP_HOME。</li>
<li><p>hivevar: user-defined variable.<br>hivevar: 用户定义的变量。</p>
</li>
<li><p>Ordinary variables can be declared with <code>--define key = value</code> or <code>--hivevar key = value</code>, which all represent variables that are hivevar.<br>普通变量可以用<code>-- define key = value</code> 或 <code>-- hivevar key = value</code> 声明，它们都表示变量是hivevar。</p>
</li>
<li><code>hive --hiveconf mapreduce.job.queuename=queue1</code><br>This setting is valid for the session started this time and needs to be reconfigured for the next startup.<br>此设置对这次启动的会话有效，下一次启动需要重新配置。</li>
<li>Set or display variables through set in hive.<br>通过在Hive中设置或显示变量。<code>set &lt;varname&gt;</code></li>
</ul>
<h3 id="Hive-Command-line"><a href="#Hive-Command-line" class="headerlink" title="Hive Command line"></a>Hive Command line</h3><ul>
<li>One-time query 一次性查询<br><code>$HIVE_HOME/bin/hive -e &#39;select a.col from tab1 a&#39;</code><br>The progress of mapreduce will be displayed on the terminal. Mapreduce的进度将显示在终端上。<br>The query results are finally output to the terminal, and hive process exits 查询结果最终输出到终端，Hive进程退出</li>
<li>Quiet mode query 安静模式查询<br><code>$HIVE_HOME/bin/hive  -S -e &#39;select a.ueserid from tab1 log&#39;</code><br>Adding  <code>-S</code>, will only output the query results to the terminal. 添加 <code>–S</code>，仅将查询结果输出到终端。<br>This silent mode is called by a third-party program, the third-party program obtains the result set through the standard output of hive. 这种静音模式是由第三方程序调用的，第三方程序通过Hive的标准输出获取结果集。</li>
<li>Execute script 执行脚本<br><code>$HIVE_HOME/bin/hive -f /home/my/hive-script.sql</code><br><code>hive-script.sql</code> is a script file written using hive sql syntax. The execution process is similar to <code>-e</code>, except that sql is loaded from a file.<br><code>hive-script.sql</code>是一个使用Hive SQL语法编写的脚本文件。执行过程类似于<code>-e</code>，只是SQL是从一个文件加载的。</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Command</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>quit/exit</code></td>
<td style="text-align:center">Exit the interactive shell</td>
</tr>
<tr>
<td style="text-align:center"><code>Reset</code></td>
<td style="text-align:center">Reset configuration to default</td>
</tr>
<tr>
<td style="text-align:center"><code>set &lt;key&gt;=&lt;value&gt;</code></td>
<td style="text-align:center">Modify the value of a specific variableNote: If the variable name is misspelled, no error will be reported</td>
</tr>
<tr>
<td style="text-align:center"><code>Set</code></td>
<td style="text-align:center">Output user-overwritten hive configuration variables</td>
</tr>
<tr>
<td style="text-align:center"><code>set -v</code></td>
<td style="text-align:center">Output all Hadoop and Hive configuration variables</td>
</tr>
<tr>
<td style="text-align:center"><code>add FILE[S] &lt;filepath&gt; &lt;filepath&gt;*</code> <br> <code>add JAR[S] &lt;filepath&gt; &lt;filepath&gt;*</code> <br> <code>add ARCHIVE[S] &lt;filepath&gt; &lt;filepath&gt;*</code></td>
<td style="text-align:center">Add one or more files, jars, archives to the distributed cache</td>
</tr>
<tr>
<td style="text-align:center"><code>list FILE[S]</code> <br> <code>list JAR[S]</code> <br> <code>list ARCHIVE[S]</code></td>
<td style="text-align:center">Outputs resources that have been added to the distributed cache.</td>
</tr>
<tr>
<td style="text-align:center"><code>list FILE[S] &lt;filepath&gt;*</code> <br> <code>list JAR[S] &lt;filepath&gt;*</code> <br> <code>list ARCHIVE[S] &lt;filepath&gt;*</code></td>
<td style="text-align:center">Check if given resource is added to distributed cache</td>
</tr>
<tr>
<td style="text-align:center"><code>delete FILE[S] &lt;filepath&gt;*</code> <br> <code>delete JAR[S] &lt;filepath&gt;*</code> <br> <code>delete ARCHIVE[S] &lt;filepath&gt;*</code></td>
<td style="text-align:center">Deletes the specified resource from the distributed cache</td>
</tr>
<tr>
<td style="text-align:center"><code>! &lt;command&gt;</code></td>
<td style="text-align:center">Execute a shell command from the Hive shell</td>
</tr>
<tr>
<td style="text-align:center"><code>dfs &lt;dfs command&gt;</code></td>
<td style="text-align:center">Execute a dfs command from the Hive shell</td>
</tr>
<tr>
<td style="text-align:center"><code>&lt;query string&gt;</code></td>
<td style="text-align:center">Execute a Hive query and output the results to standard output</td>
</tr>
<tr>
<td style="text-align:center"><code>source FILE &lt;filepath&gt;</code></td>
<td style="text-align:center">Execute a hive script file in the CLI</td>
</tr>
</tbody>
</table>
</div>
<h3 id="HIVE-Data-Type"><a href="#HIVE-Data-Type" class="headerlink" title="HIVE Data Type"></a>HIVE Data Type</h3><p>Primary data types<br>TINYINT, SMALLINT, INT, BIGINT, FLOAT, DOUBLE, BOOLEAN, STRING<br>Complex Data Types</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Type</th>
<th style="text-align:center">Description</th>
<th style="text-align:center">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ARRAY</td>
<td style="text-align:center">A set of ordered fields. Field must be of same type.</td>
<td style="text-align:center"><code>Array(1, 2)</code></td>
</tr>
<tr>
<td style="text-align:center">MAP</td>
<td style="text-align:center">An unordered set of key/value pairs. The key type must be atomic, the value can be any type. The key type of the same mapping must be the same, and the value type must be the same.</td>
<td style="text-align:center"><code>Map(&#39;a&#39;, 1, &#39;b&#39;, 2)</code></td>
</tr>
<tr>
<td style="text-align:center">STRUCT</td>
<td style="text-align:center">A set of named fields. The field type can be different.</td>
<td style="text-align:center"><code>Struct(&#39;a&#39;,1,1,0)</code></td>
</tr>
</tbody>
</table>
</div>
<h2 id="Chapter-2"><a href="#Chapter-2" class="headerlink" title="Chapter 2"></a>Chapter 2</h2><h3 id="Database-Operations"><a href="#Database-Operations" class="headerlink" title="Database Operations"></a>Database Operations</h3><ul>
<li>SHOW DATABASE: <code>show databases;</code></li>
<li><p>CREATE DATABASE: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> [<span class="keyword">EXTERNAL</span>] <span class="keyword">TABLE</span> [<span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] table_name </span><br><span class="line">[(col_name data_type [<span class="keyword">COMMENT</span> col_comment], ...)] </span><br><span class="line">[<span class="keyword">COMMENT</span> table_comment] </span><br><span class="line">[PARTITIONED <span class="keyword">BY</span> (col_name data_type [<span class="keyword">COMMENT</span> col_comment], ...)] </span><br><span class="line">[CLUSTERED <span class="keyword">BY</span> (col_name, col_name, ...) </span><br><span class="line">[SORTED <span class="keyword">BY</span> (col_name [<span class="keyword">ASC</span>|<span class="keyword">DESC</span>], ...)] <span class="keyword">INTO</span> num_buckets BUCKETS] </span><br><span class="line">[<span class="keyword">ROW</span> <span class="keyword">FORMAT</span> <span class="keyword">DELIMITED</span> row_format] </span><br><span class="line">[<span class="keyword">STORED</span> <span class="keyword">AS</span> file_format] </span><br><span class="line">[LOCATION hdfs_path]</span><br></pre></td></tr></table></figure>
</li>
<li><p>USE DATABASE: <code>use database;</code></p>
</li>
<li>DELETE DATABASE: <code>DROP DATABASE [IF EXISTS] &lt;database name&gt;</code></li>
</ul>
<h3 id="Table-Operations"><a href="#Table-Operations" class="headerlink" title="Table Operations"></a>Table Operations</h3><ul>
<li><p>CREATE TABLE  :<br>Creates a table with the specified name.<br>If a table with the same name already exists, an exception is thrown;<br>The user can use the IF NOT EXIST option to ignore this exception. </p>
</li>
<li><p>EXTERNAL :<br>External  keyword allows users to create an external table, and specify a path to the actual data (LOCATION).<br>When you delete external table only deletes the metadata, not the data.</p>
</li>
<li><p>ROW FORMAT DELIMITED] :<br>[ROW FORMAT DELIMITED]keyword is used to set the column separators supported by the created table when loading data.</p>
</li>
<li>[STORED AS file_format] :<br>specifies the file storage format. The default is TEXTFILE. If the file data is plain text, [STORED AS TEXTFILE] is used and then copied directly to HDFS from the local.</li>
<li>Partitioned tables can be created using the PARTITIONED BY statement. A table can have one or more partitions, and each partition exists in a separate directory. </li>
<li>Both tables and partitions can perform a CLUSTERED BY operation on a certain column and put several columns into a bucket. You can also use SORT BY to sort the data. This can improve performance for specific applications.</li>
</ul>
<h4 id="File-formats"><a href="#File-formats" class="headerlink" title="File formats"></a>File formats</h4><ul>
<li><p>TEXTFILE:<br>The TEXTFILE is default format. Data is not compressed. It has a large disk overhead and a large data parsing overhead.</p>
</li>
<li><p>SEQUENCEFILE:<br>SEQUENCEFILE a binary file support provided by the Hadoop API, which is easy to use, splittable and compressible.</p>
</li>
<li><p>RCFILE:<br>RCFILE is a combination of row and column storage.</p>
</li>
<li><p>Custom format: </p>
<ul>
<li>When the user’s data file format cannot be recognized by the current Hive, you can customize the file format.</li>
<li>Users can customize input and output formats by implementing inputformat and outputformat.</li>
</ul>
</li>
</ul>
<h4 id="CREATE-TABLE"><a href="#CREATE-TABLE" class="headerlink" title="CREATE TABLE"></a>CREATE TABLE</h4><ul>
<li>Create a normal table：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Emp_table (<span class="keyword">id</span> <span class="built_in">int</span>,<span class="keyword">name</span> <span class="keyword">string</span>,<span class="keyword">no</span> <span class="built_in">int</span>) </span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">',’ stored as textfile;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Note : A field separator is specified. HIVE only supports a single character separator. The default delimiter for hive is \ 001.</p>
<ul>
<li>Create a partitioned table<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Emp_partition (<span class="keyword">id</span> <span class="built_in">int</span>,<span class="keyword">name</span> <span class="keyword">string</span>,<span class="keyword">no</span> <span class="built_in">int</span>) partitioned <span class="keyword">by</span> (dt <span class="keyword">string</span>) </span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">',’  stored as textfile ;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>load data local inpath <code>&#39;/opt/niit/hive/test_hive.txt&#39;</code> overwrite into table test_partition partition (dt=’2015-06-15’);</p>
<ul>
<li><p>Create a bucket table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Emp_bucket (<span class="keyword">id</span> <span class="built_in">int</span>,<span class="keyword">name</span> <span class="keyword">string</span>,<span class="keyword">no</span> <span class="built_in">int</span>) partitioned <span class="keyword">by</span> (dt <span class="keyword">string</span>) </span><br><span class="line">clustered <span class="keyword">by</span> (<span class="keyword">id</span>) sorted <span class="keyword">by</span>(<span class="keyword">name</span>) <span class="keyword">into</span> <span class="number">3</span> buckets </span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span></span><br><span class="line"><span class="keyword">stored</span> <span class="keyword">as</span> textfile;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Create an external table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">external</span> <span class="keyword">table</span> Emp_external (<span class="keyword">id</span> <span class="built_in">int</span>,<span class="keyword">name</span> <span class="keyword">string</span>,<span class="keyword">no</span> <span class="built_in">int</span>)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">',’ ;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Copy table structure</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Emp_like_table <span class="keyword">like</span> Emp_bucket;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>The above command copies table structure only, not content</p>
<h3 id="Modify-Table-Operations"><a href="#Modify-Table-Operations" class="headerlink" title="Modify Table Operations"></a>Modify Table Operations</h3><ul>
<li><p>Increase partition<br>Syntax：<code>ALTER TABLE table_name ADD partition_spec [ LOCATION &#39;location1&#39;] partition_spec [ LOCATION &#39;location2&#39; ]</code><br>Example：<code>alter table Emp_partition add partition (dt=&#39;2015-06-15&#39;)</code></p>
</li>
<li><p>Delete partition<br>Syntax：<code>ALTER TABLE table_name DROP partition_spec</code><br>Example：<code>alter table Emp_partition drop partition (dt=&#39;2015-06-15&#39;)</code><br>Description：After the partition is deleted, the metadata and data of the partition will be deleted together.</p>
</li>
</ul>
<h3 id="Table-Operations-1"><a href="#Table-Operations-1" class="headerlink" title="Table Operations"></a>Table Operations</h3><ul>
<li><p>Table rename<br>Syntax：<code>ALTER TABLE table_name RENAME TO new_table_name</code><br>Example：<code>alter table Emp_partition rename to new_Emp_partition;</code><br>Description：The location of the data and the partition name do not change.</p>
</li>
<li><p>Modify table column type<br>Syntax：<code>ALTER TABLE table_name CHANGE [COLUMN] col_old_name col_new_name column_type [COMMENT col_comment] [FIRST|AFTER column_name]</code><br>Example：<code>alter table New_Emp_partition change name name1 String;</code></p>
</li>
<li><p>Add column<br>Syntax：<code>ALTER TABLE table_name ADD|REPLACE COLUMNS (col_name data_type [COMMENT col_comment], ...)</code><br>Example：<code>alter table New_Emp_partition  add columns (age int);</code></p>
</li>
</ul>
<h3 id="Data-loading"><a href="#Data-loading" class="headerlink" title="Data loading"></a>Data loading</h3><ul>
<li>Hive does not support insert operations using insert statements one by one. It also  does not  support update operations.<br>Hive不支持使用一个接一个的插入语句进行插入操作。它也不支持更新操作。</li>
<li>The data is loaded into the established table in the manner of load.<br>数据以加载的方式加载到已建立的表中。</li>
<li>Once the data is imported, it cannot be modified.  We can either drop the entire table or create a new table and import the required data.<br>一旦数据被导入，它就不能被修改。 我们可以删除整个表，也可以创建一个新表并导入所需的数据。</li>
</ul>
<p>Syntax：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LOAD</span> <span class="keyword">DATA</span> [<span class="keyword">LOCAL</span>] INPATH <span class="string">'filepath'</span> [OVERWRITE] <span class="keyword">INTO</span> <span class="keyword">TABLE</span> tablename [<span class="keyword">PARTITION</span> (partcol1=val1, partcol2=val2 ...)]</span><br></pre></td></tr></table></figure></p>
<h3 id="Ways-to-Import-data-in-batches"><a href="#Ways-to-Import-data-in-batches" class="headerlink" title="Ways to Import data in batches"></a>Ways to Import data in batches</h3><ul>
<li>Load data and import to the specified table    加载数据并导入到指定的表<br>Import the local file system /home/data/aa.txt file into tab1,<br>syntax : <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/home/data/aa.txt'</span> <span class="keyword">into</span> <span class="keyword">table</span> tab1;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Import the file directly to the partition of the specified table. If the partition directory does not exist, hive will automatically create a partition directory, and then copy the data to the directory.<br>将文件直接导入指定表的分区。如果分区目录不存在，HIVE将自动创建一个分区目录，然后将数据复制到该目录。</p>
<ul>
<li>Load to the partition of the specified table    加载到指定表的分区<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LOAD DATA LOCAL INPATH &apos;/home/admin/test/test.txt’</span><br><span class="line">OVERWRITE INTO TABLE test_1 PARTITION（pt=’xxxx’）</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>The keyword [OVERWRITE] means to overwrite the data in the original table. If it is not written, it will not be overwritten.<br>关键字[OVERWRITE]表示覆盖原始表中的数据。如果不写，就不会被覆盖。<br>The keyword [LOCAL] means that the source of the file you are loading is a local file. If you do not write, the file is hdfs.<br>关键字[LOCAL]表示正在加载的文件的源是一个本地文件。如果不写，文件是HDFS。</p>
<ul>
<li>Import data using insert + select<br>By querying the table, the query results are imported into the specified table.    通过查询表，查询结果被导入到指定的表中。<br>Syntax ：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> tablename1 [<span class="keyword">PARTITION</span> (partcol1=val1, partcol2=val2 ...)] select_statement1 <span class="keyword">FROM</span> from_statement</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">into</span> tab2 <span class="keyword">select</span> * <span class="keyword">from</span> tab1；</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Import data using create+select<br>Create a new table and copy the data into this table.<br>创建一个新表并将数据复制到这个表中。<br>Syntax：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tablename1 <span class="keyword">AS</span>  select_statement1 <span class="keyword">FROM</span> from_statement  </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">table</span> tab2 <span class="keyword">as</span> <span class="keyword">select</span> * <span class="keyword">from</span> tab1;</span><br></pre></td></tr></table></figure></p>
<h3 id="Management-tables"><a href="#Management-tables" class="headerlink" title="Management tables"></a>Management tables</h3><ul>
<li>The management table is also called an internal table.<br>管理表也称为内部表。</li>
<li>Hive controls the life cycle of the table and the data in the table.<br>Hive控制表的生命周期和表中的数据。</li>
<li>The data is stored in the directory set by the parameter hive.metastore.warehouse.dir in hive-site.xml.<br>数据存储在参数设置的目录中：</li>
<li>When Hive creates the internal tables, it moves the data to the path pointed to by the data warehouse.<br>当Hive创建内部表时，它将数据移动到数据仓库指向的路径。</li>
<li>When a management table is deleted, the corresponding data in the table is also deleted at the same time.<br>删除管理表时，同时也删除表中相应的数据。</li>
<li>We can create a management table by using the <code>create table</code> command.<br>我们可以使用create table命令来创建一个管理表。</li>
</ul>
<h3 id="External-tables"><a href="#External-tables" class="headerlink" title="External tables"></a>External tables</h3><ul>
<li>The data of the external table is not managed by hive, hive just establishes a reference.<br>外部表的数据不是由hive管理的，hive只是建立一个引用。</li>
<li>When deleting an external table, only the metadata of the table is deleted, not the data.<br>删除外部表时，只删除表的元数据，而不删除数据。</li>
<li>The external table is relatively more secure, and the data organization is more flexible, which facilitates the sharing of source data.<br>外部表相对更安全，数据组织也更灵活，这有助于共享源数据。</li>
<li>Create table Use “create EXTERNAL table” to create external tables.<br>创建表使用创建外部表来创建外部表。</li>
</ul>
<h3 id="Partition-Table"><a href="#Partition-Table" class="headerlink" title="Partition Table"></a>Partition Table</h3><ul>
<li>Hive Select query scan  the entire table  which  is time consuming.<br>在HIVE选择查询扫描整个表，这是耗时的。</li>
<li>Sometimes only a part of the data in the table needs to be scanned, so the partition concept was introduced when the table was created.<br>有时只需要扫描表中的一部分数据，因此在创建表时引入了分区概念。</li>
<li>A partitioned table refers to the partition space of the partition specified when the table was created.<br>分区表是指在创建表时指定的分区的分区空间。</li>
<li>To create a partitioned table, you need to use  the optional parameter partitioned by.<br>要创建分区表，需要使用可选的分区参数。</li>
<li>A table can have one or more partitions, and each partition exists in the directory of the table folder in the form of a folder.<br>一个表可以有一个或多个分区，每个分区都以文件夹的形式存在于表文件夹的目录中。</li>
<li>Table and column names are not case sensitive.<br>表名和列名不区分大小写。</li>
<li>Partitions exist in the table structure in the form of fields.<br>分区以字段的形式存在于表结构中。</li>
<li>You can see that the fields  through the <code>describe table</code> command, but this field does not store the actual data , they are only the representation of the partition.<br>你可以通过<code>describe table</code>命令看到这些字段，但是这个字段并不存储实际的数据，它们只是分区的表示。</li>
</ul>
<p>Types of partition table creation   分区表创建的类型</p>
<ul>
<li>Single partition: Which means that there is only one level folder directory under the table folder directory.<br>单分区: 这意味着在表文件夹目录下只有一个级别的文件夹目录。Statement: create table day_table (id int, content string) partitioned by (dt string);</li>
<li>Multi-partitioning: A multi-folder nesting mode appears under the table folder.<br>多分区: 在表文件夹下出现多文件夹嵌套模式。<br>Statement: <code>create table day_hour_table (id int, content string) partitioned by (dt string, hour string);</code></li>
<li>Dual partition table, partitioned by day and hour, added dt and hour two columns in the table structure.<br>双分区表，按日和时进行分区，在表结构中增加了dt和时两列。</li>
<li>Partition table contains Static partition and Dynamic partition<br>分区表包含静态分区和动态分区</li>
</ul>
<p>Static Partition Table</p>
<ul>
<li>It is recommended to create a partitioned column before importing data.<br>建议在导入数据之前创建分区列。</li>
<li>If you do not create the partition first, the partition is created automatically.<br>如果你没有首先创建分区，那么将会自动创建分区。</li>
</ul>
<p>Dynamic Partition Table</p>
<ul>
<li>Dynamic partitioning can be automatically matched to the corresponding partition according to the data obtained by the query.<br>动态分区可以根据查询得到的数据自动匹配到相应的分区。</li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li>NIIT</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/note/" rel="tag"><i class="fa fa-tag"></i> note</a>
          
            <a href="/tags/hive/" rel="tag"><i class="fa fa-tag"></i> hive</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/problem-pta/" rel="next" title="PTA部分题解">
                <i class="fa fa-chevron-left"></i> PTA部分题解
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/note-algorithm-bp/" rel="prev" title="算法设计与分析笔记bp">
                算法设计与分析笔记bp <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="comments" id="comments">
        <div id="gitalk-container"></div>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="北屿">
          <p class="site-author-name" itemprop="name">北屿</p>
           
              <p class="site-description motion-element" itemprop="description">Sometimes it's the very people who no one imagines angthing of who do the things that no one can imagine.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">100</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">92</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/beiyuouo" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://weibo.com/u/5687969852" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                    
                      Weibo
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://wpa.qq.com/msgrd?v=3&uin=729320011&site=qq&menu=yes" target="_blank" title="QQ">
                  
                    <i class="fa fa-fw fa-qq"></i>
                  
                    
                      QQ
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/bei-yu-84-25/activities" target="_blank" title="ZhiHu">
                  
                    <i class="fa fa-fw fa-unlink"></i>
                  
                    
                      ZhiHu
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-link"></i>
              Links qwq
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://baidu.com/" title="欢迎友链qwq" target="_blank">欢迎友链qwq</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://borber.cn/" title="BORBER's blog" target="_blank">BORBER's blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://47.101.152.169/" title="mon-soon's blog" target="_blank">mon-soon's blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://blog.0xbbc.com/" title="0xbbc's blog" target="_blank">0xbbc's blog</a>
                </li>
              
            </ul>
          </div>
        

        

      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction-to-Hive"><span class="nav-number">1.</span> <span class="nav-text">Introduction to Hive</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Difference-between-SQL-and-NoSQL"><span class="nav-number">1.1.</span> <span class="nav-text">Difference between SQL and NoSQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-Hive"><span class="nav-number">1.2.</span> <span class="nav-text">What is Hive</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Who-developed-Hive"><span class="nav-number">1.3.</span> <span class="nav-text">Who developed Hive</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Why-Hive-was-developed"><span class="nav-number">1.4.</span> <span class="nav-text">Why Hive was developed?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-and-when-it-can-be-used"><span class="nav-number">1.5.</span> <span class="nav-text">How and when it can be used?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#When-Hive-cannot-be-used"><span class="nav-number">1.6.</span> <span class="nav-text">When Hive cannot be used?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Features-of-Hive"><span class="nav-number">1.7.</span> <span class="nav-text">Features of Hive</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Difference-between-Hive-amp-RDBMS"><span class="nav-number">1.8.</span> <span class="nav-text">Difference between Hive &amp; RDBMS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hive-Chapter-1"><span class="nav-number">2.</span> <span class="nav-text">Hive Chapter 1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-Hive-1"><span class="nav-number">2.1.</span> <span class="nav-text">What is Hive?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-to-analyze-and-manage-data-如何分析和管理数据"><span class="nav-number">2.2.</span> <span class="nav-text">How to analyze and manage data? 如何分析和管理数据?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HIVE-Data-Storage-Model-HIVE数据存储模型"><span class="nav-number">2.3.</span> <span class="nav-text">HIVE Data Storage Model.  HIVE数据存储模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HIVE-Data-Storage-Hive数据存储"><span class="nav-number">2.4.</span> <span class="nav-text">HIVE Data Storage. Hive数据存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hive-Data-Models-Table-Hive-数据模型-Table"><span class="nav-number">2.5.</span> <span class="nav-text">Hive Data Models-Table. Hive 数据模型-Table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hive-Data-Models-External-Table-Hive-数据模型"><span class="nav-number">2.6.</span> <span class="nav-text">Hive Data Models-External Table. Hive 数据模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hive-Data-Models-Partition-Hive-数据模型-Partition"><span class="nav-number">2.7.</span> <span class="nav-text">Hive Data Models-Partition. Hive 数据模型-Partition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hive-Data-Models-Bucket-Hive-数据模型-Bucket"><span class="nav-number">2.8.</span> <span class="nav-text">Hive Data Models-Bucket. Hive 数据模型-Bucket</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hive-MetaData"><span class="nav-number">2.9.</span> <span class="nav-text">Hive MetaData</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hive-Storage-model"><span class="nav-number">2.10.</span> <span class="nav-text">Hive Storage model</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Database-Model"><span class="nav-number">2.11.</span> <span class="nav-text">Database Model</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hive-Installation"><span class="nav-number">2.12.</span> <span class="nav-text">Hive Installation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基于Derby"><span class="nav-number">2.12.1.</span> <span class="nav-text">基于Derby</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#基于Mysql"><span class="nav-number">2.12.2.</span> <span class="nav-text">基于Mysql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CLI-Options"><span class="nav-number">2.13.</span> <span class="nav-text">CLI Options</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Variable-setting"><span class="nav-number">2.14.</span> <span class="nav-text">Variable setting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hive-Command-line"><span class="nav-number">2.15.</span> <span class="nav-text">Hive Command line</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HIVE-Data-Type"><span class="nav-number">2.16.</span> <span class="nav-text">HIVE Data Type</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Chapter-2"><span class="nav-number">3.</span> <span class="nav-text">Chapter 2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Database-Operations"><span class="nav-number">3.1.</span> <span class="nav-text">Database Operations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Table-Operations"><span class="nav-number">3.2.</span> <span class="nav-text">Table Operations</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#File-formats"><span class="nav-number">3.2.1.</span> <span class="nav-text">File formats</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CREATE-TABLE"><span class="nav-number">3.2.2.</span> <span class="nav-text">CREATE TABLE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Modify-Table-Operations"><span class="nav-number">3.3.</span> <span class="nav-text">Modify Table Operations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Table-Operations-1"><span class="nav-number">3.4.</span> <span class="nav-text">Table Operations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Data-loading"><span class="nav-number">3.5.</span> <span class="nav-text">Data loading</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ways-to-Import-data-in-batches"><span class="nav-number">3.6.</span> <span class="nav-text">Ways to Import data in batches</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Management-tables"><span class="nav-number">3.7.</span> <span class="nav-text">Management tables</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#External-tables"><span class="nav-number">3.8.</span> <span class="nav-text">External tables</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Partition-Table"><span class="nav-number">3.9.</span> <span class="nav-text">Partition Table</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">4.</span> <span class="nav-text">Reference</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2018 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">北屿</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  







  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: '3bd523d04a7fcd807bd1',
          clientSecret: '3c4d80f8fd534840b0571ebf194825129668c1fe',
          repo: 'gitalk',
          owner: 'beiyuouo',
          admin: ['beiyuouo'],
          id: md5(location.pathname),
          abels: 'gitalk'.split(',').filter(l => l),
          perPage: 10,
          pagerDirection: 'last',
          createIssueManually: true,
          distractionFreeMode: false
        })
        gitalk.render('gitalk-container')           
       </script>




  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

#
#<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
#<!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
